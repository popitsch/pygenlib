Test data files

- own testdata project: pygentest
    - motivation: genomics methods development needs reproducible test data
    - community project!
- nextflow DSL2 pipeline with samtools+bedtools in singularity container
    - input is config file that defines test resources (e.g., bam + bai)
        - possibly manually downloaded files as input
    - modules for downloading, indexing and slicing large genomics files
- small test files directly in github
    - specially created test files
    - small + buggy file formats
    - use file uri for those; simple copy
- related work
    nfcore test datasets
    https://github.com/nf-core/test-datasets/tree/master
    (one branch per nf-core pipeline)

result:
    testdatadir/
        config.json (contains resources and relative file paths)
            {
                "resource1": {
                    "description": "this is a small example"
                    "file": "resource1/file1.gz"
                },
                "resource2": {
                    "description": "this is a small example"
                    "files": ["resource2/fastq.R1.fq.gz", "resource2/fastq.R2.fq.gz"]
                },
            }
        resource1/file1.gz
                 /file1.gz.tbi
        resource2/fastq.R1.fq.gz
                 /fastq.R2.fq.gz

use in your python project:
    copy ""@pytest.fixture def base_path()"" to your test_XXX.py file
    define def test_XXX(base_path)
    access files via config['resource_id']['file']
                     config['resource_id']['files']
                     or directly via path


gencode.v39.ACTB+SOX2.gff3: Human ACTB and SOX2 annotations extracted from gencode v39
UCSC.hg38.ncbiRefSeq.ACTB+SOX2.sorted.gtf.gz: Human ACTB and SOX2 annotations extracted from UCSC ncbiRefSeq data
flybase.dmel-all-r6.51.sorted.gtf.gz: flybase full annotation
mirgenedb.dme.sorted.gff3.gz: mirgenedb dmel annotations
GRCh38.k24.umap.ACTB_ex1+2.bedgraph.gz: umap mappability scores for ACTB exons 1+2 (https://bismap.hoffmanlab.org/)
FAT61995_a1291c8f_5.fast5: example FAST5 Nanopore sequencing file
dmelanogaster_6_exported_20230523.vcf.gz: exported from https://www.ebi.ac.uk/eva/?Variant-Browser&species=dmelanogaster_6&selectFilter=region&studies=SNPASSAY_4_SUBMISSION_2010_11_14&region=2L%3A574291-575734

1) put the following URL into your web browser and save as .vcf
https://www.ebi.ac.uk/eva/webservices/vcf-dumper/v1/segments/2L%3A574291-575734/variants?species=dmelanogaster_6&studies=SNPASSAY_4_SUBMISSION_2010_11_14




https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_44/gencode.v44.annotation.gff3.gz

# GFF flavours

ENSEMBL gff/ensembl_Homo_sapiens.GRCh38.110.ACTB+SOX2.gff3.gz
	3	ensembl_havana	gene	181711925	181714436	.	+	.	ID=gene:ENSG00000181449;Name=SOX2;biotype=protein_coding;description=SRY-box transcription factor 2 [Source:HGNC Symbol%3BAcc:HGNC:11195];gene_id=ENSG00000181449;logic_name=ensembl_havana_gene_homo_sapiens;version=4
	3	ensembl_havana	mRNA	181711925	181714436	.	+	.	ID=transcript:ENST00000325404;Parent=gene:ENSG00000181449;Name=SOX2-201;biotype=protein_coding;ccdsid=CCDS3239.1;tag=basic,Ensembl_canonical,MANE_Select;transcript_id=ENST00000325404;transcript_support_level=NA (assigned to previous version 2);version=3
	3	ensembl_havana  exon    181711925       181714436       .       +       .       Parent=transcript:ENST00000325404;Name=ENSE00001228743;constitutive=1;ensembl_end>

	7	ensembl_havana	gene	5526409	5563902	.	-	.	ID=gene:ENSG00000075624;Name=ACTB;biotype=protein_coding;description=actin beta [Source:HGNC Symbol%3BAcc:HGNC:132];gene_id=ENSG00000075624;logic_name=ensembl_havana_gene_homo_sapiens;version=17
	7	havana	transcript	5528717	5530601	.	-	.	ID=transcript:ENST00000484841;Parent=gene:ENSG00000075624;Name=ACTB-211;biotype=protein_coding_CDS_not_defined;transcript_id=ENST00000484841;transcript_support_level=5 (assigned to previous version 5);version=6
	7       havana  exon    5526409 5527891 .       -       .       Parent=transcript:ENST00000674681;Name=ENSE00003899998;constitutive=0;ensembl_end_phase=-1;ensembl_phase=>
FT: CDS biological_region chromosome exon five_prime_UTR gene lnc_RNA mRNA ncRNA_gene pseudogene pseudogenic_transcript three_prime_UTR transcript

GENCODE gff/gencode_44.ACTB+SOX2.gff3.gz
	chr3    HAVANA  gene    181711925       181714436       .       +       .       ID=ENSG00000181449.4;gene_id=ENSG00000181449.4;gene_type=protein_coding;gene_name=SOX2;le>
	chr3    HAVANA  transcript      180989770       181791029       .       +       .       ID=ENST00000626948.3;Parent=ENSG00000242808.12;gene_id=ENSG00000242808.12;transcr>
	chr3    HAVANA  exon    181711925       181714436       .       +       .       ID=exon:ENST00000325404.3:1;Parent=ENST00000325404.3;gene_id=ENSG00000181449.4;transcript>

	chr7    HAVANA  gene    5526409 5563902 .       -       .       ID=ENSG00000075624.17;gene_id=ENSG00000075624.17;gene_type=protein_coding;gene_name=ACTB;level=2;hgnc_id=>
	chr7    HAVANA  transcript      5526409 5530601 .       -       .       ID=ENST00000674681.1;Parent=ENSG00000075624.17;gene_id=ENSG00000075624.17;transcript_id=ENST00000>
	chr7    HAVANA  exon    5526409 5527891 .       -       .       ID=exon:ENST00000674681.1:6;Parent=ENST00000674681.1;gene_id=ENSG00000075624.17;transcript_id=ENST0000067>
FT: CDS exon five_prime_UTR gene start_codon stop_codon three_prime_UTR transcript

GENCODE gff/gencode_44.ACTB+SOX2.gtf.gz
    chr3    HAVANA  gene    181711925       181714436       .       +       .       gene_id "ENSG00000181449.4"; gene_type "protein_coding"; gene_name "SOX2"; level 2; hgnc_>
    chr3    HAVANA  transcript      181711925       181714436       .       +       .       gene_id "ENSG00000181449.4"; transcript_id "ENST00000325404.3"; gene_type "protei>
    chr3    HAVANA  exon    181711925       181714436       .       +       .       gene_id "ENSG00000181449.4"; transcript_id "ENST00000325404.3"; gene_type "protein_coding>

    chr7    HAVANA  gene    5526409 5563902 .       -       .       gene_id "ENSG00000075624.17"; gene_type "protein_coding"; gene_name "ACTB"; level 2; hgnc_id "HGNC:132"; >
    chr7    HAVANA  transcript      5526409 5530601 .       -       .       gene_id "ENSG00000075624.17"; transcript_id "ENST00000674681.1"; gene_type "protein_coding"; gene>
    chr7    HAVANA  exon    5526409 5527891 .       -       .       gene_id "ENSG00000075624.17"; transcript_id "ENST00000674681.1"; gene_type "protein_coding"; gene_name "A>
FT: CDS UTR exon gene start_codon stop_codon transcript


FLYBASE gff/flybase_dmel-2L-r6.36.gtf.gz
	2L      FlyBase gene    7529    9484    .       +       .       gene_id "FBgn0031208"; GeneSymbol "CR11023";
	2L      FlyBase mRNA    9839    21376   .       -       .       gene_id "FBgn0002121"; GeneSymbol "l(2)gl"; transcript_id "FBtr0306589"; transcript_symbol "l(2)gl-RG";
	2L      FlyBase exon    7529    8116    .       +       .       gene_id "FBgn0031208"; GeneSymbol "CR11023"; transcript_id "FBtr0475186"; transcript_symbol "CR11023-RE";
FT: 3UTR 5UTR CDS exon gene mRNA ncRNA pseudogene start_codon stop_codon


UCSC gff/UCSC.hg38.ncbiRefSeq.ACTB+SOX2.sorted.gtf.gz

	# no gene entries
	chr3    ncbiRefSeq.2022-10-28   transcript      181711925       181714436       .       +       .       gene_id "SOX2"; transcript_id "NM_003106.4";  gene_name "SOX2";
	chr3    ncbiRefSeq.2022-10-28   exon    181711925       181714436       .       +       .       gene_id "SOX2"; transcript_id "NM_003106.4"; exon_number "1"; exon_id "NM>

	chr7    ncbiRefSeq.2022-10-28   transcript      5527148 5530601 .       -       .       gene_id "ACTB"; transcript_id "NM_001101.5";  gene_name "ACTB";
	chr7    ncbiRefSeq.2022-10-28   exon    5527148 5527891 .       -       .       gene_id "ACTB"; transcript_id "NM_001101.5"; exon_number "6"; exon_id "NM_001101.5.6"; ge>
FT: 3UTR 5UTR CDS exon start_codon stop_codon transcript

CHESS gff/chess3.GRCh38.ACTB+SOX2.gff3.gz
	# no gene entries
	chr3    MANE    transcript      181711925       181714436       .       +       .       ID=CHS.39078.3; Parent=CHS.39078; gene_name=SOX2; gene_type=protein_coding; db_xr>
	chr3    MANE    exon    181711925       181714436       .       +       .       Parent=CHS.39078.3; gene_name=SOX2;

	chr7    MANE    transcript      5527148 5530601 .       -       .       ID=CHS.49814.4; Parent=CHS.49814; gene_name=ACTB; gene_type=protein_coding; db_xref=RefSeq:NM_001>
	chr7    MANE    exon    5527148 5527891 .       -       .       Parent=CHS.49814.4; gene_name=ACTB;
FT: CDS exon transcript

CHESS gff/chess3.GRCh38.ACTB+SOX2.gtf.gz
	# no gene entries
	# exon/tx not sorted properly!

	chr3    MANE    exon    181711925       181714436       .       +       .       transcript_id "CHS.39078.3"; gene_id "CHS.39078"; gene_name "SOX2";
	chr3    MANE    transcript      181711925       181714436       .       +       .       transcript_id "CHS.39078.3"; gene_id "CHS.39078"; gene_name "SOX2"; gene_type "pr>

	chr7    MANE    transcript      5527148 5530601 .       -       .       transcript_id "CHS.49814.4"; gene_id "CHS.49814"; gene_name "ACTB"; gene_type "protein_coding"; d>
	chr7    MANE    exon    5527148 5527891 .       -       .       transcript_id "CHS.49814.4"; gene_id "CHS.49814"; gene_name "ACTB";
FT: CDS exon transcript

Mirgendb gff/mirgenedb.dme.sorted.gff3.gz
	2L      .       pre_miRNA       243055  243118  .       -       .       ID=Dme-Mir-965_pre;Alias=MI0005821
	2L      .       miRNA   243055  243076  .       -       .       ID=Dme-Mir-965_3p;Alias=MIMAT0005480
	2L      .       miRNA   243096  243118  .       -       .       ID=Dme-Mir-965_5p*;Alias=MIMAT0020861
FT: pre_miRNA, miRNA

generic_gff3
	2L	.	gene	243055	243118	.	-	.	ID=Dme-Mir-965_pre;Alias=MI0005821
	2L	.	transcript	243055	243076	.	-	.	ID=Dme-Mir-965_3p;Alias=MIMAT0005480
	2L	.	ft1	243096	243118	.	-	.	ID=Dme-Mir-965_5p*;Alias=MIMAT0020861
??


